# DSS5104-MolecularPropertiesGNN

# GCN主流程


##  配置参数
BATCH_SIZE = 32          # 每个批次的分子数量 
EPOCHS = 50              # 每个任务训练30轮
LEARNING_RATE = 0.001    # 优化器学习率
HIDDEN_DIM = 128         # GCN隐藏层维度

##  数据预处理模块
读取CSV文件

删除指定毒性指标的缺失值样本

比如当处理NR-AR任务时，只保留该列非空样本

##  分子图转换模块
分子图表示：

原子特征：6个化学相关特征

边特征：3个键特性

关键数据结构：

x: 形状为 [num_atoms, 6] 的原子特征矩阵

edge_index: 形状为 [2, num_edges] 的边连接索引

edge_attr: 形状为 [num_edges, 3] 的边特征矩阵

##  数据集类
核心作用：将原始数据转换为PyTorch Geometric需要的图数据格式

##  GCN模型类
关键操作：

图卷积：提取局部结构特征

全局池化：将原子级特征转换为分子级特征

维度压缩：将输出从 [batch_size, 1] 变为 [batch_size]

##  单任务训练函数
任务隔离：每个毒性预测作为独立二分类问题

优势：避免多任务学习的复杂参数调整

代价：需要训练12个独立模型

关键阶段：

前向传播：分子图 → GCN → 预测值

损失计算：二元交叉熵损失

反向传播：自动梯度计算

参数更新：Adam优化器调整权重


##  主执行流程
遍历所有12个毒性指标

对每个指标单独训练模型

记录每个任务的测试AUC

每个任务独立保存最佳模型 (best_model_{target}.pth)

最终输出汇总结果